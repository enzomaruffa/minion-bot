{% extends "base.html" %}
{% block title %}Mood - Minion{% endblock %}
{% block content %}
<h2>Mood Tracker</h2>

{% if stats and stats.count > 0 %}
<div class="grid-stats">
    <div class="stat-card">
        <div class="value">{{ stats.avg }}</div>
        <div class="label">Average ({{ stats.count }} days)</div>
    </div>
    <div class="stat-card">
        <div class="value">{{ stats.trend|title }}</div>
        <div class="label">Trend</div>
    </div>
    {% if stats.best_day %}
    <div class="stat-card">
        <div class="value">{{ stats.best_score }}/5</div>
        <div class="label">Best ({{ stats.best_day }})</div>
    </div>
    {% endif %}
</div>
{% endif %}

<h4>Log Today</h4>
<form hx-post="/app/mood" hx-target="#mood-list" hx-swap="afterbegin" hx-on::after-request="this.reset();" style="display: flex; gap: 0.5rem; align-items: end; margin-bottom: 1.5rem;">
    <div style="display: flex; gap: 0.75rem;">
        {% for score, emoji in [(1, '&#128542;'), (2, '&#128533;'), (3, '&#128528;'), (4, '&#128578;'), (5, '&#128516;')] %}
        <label style="cursor: pointer; font-size: 1.5rem; text-align: center;">
            <input type="radio" name="score" value="{{ score }}" style="display: block; margin: 0 auto;" {% if score == 3 %}checked{% endif %}>
            {{ emoji }}
        </label>
        {% endfor %}
    </div>
    <input type="text" name="note" placeholder="Note (optional)" style="margin-bottom: 0; flex: 1;">
    <button type="submit" style="width: auto; margin-bottom: 0;">Log</button>
</form>

<h4>History</h4>
<div id="mood-list">
{% for m in logs %}
{% include "partials/mood_row.html" %}
{% else %}
<p style="color: var(--pico-muted-color);">No mood logs yet.</p>
{% endfor %}
</div>
{% endblock %}
